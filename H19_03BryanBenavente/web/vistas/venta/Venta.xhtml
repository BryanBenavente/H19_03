<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>Equipo</title>
        <f:event type="preRenderView" listener="#{equipoC.listar()}"/>
    </h:head>
    <h:body>       
        <p:growl showDetail="true" life="1000" id="msg"/>        
        <h:form id="venta">
            <h1 style="color: coral">Venta</h1>
            <p:panelMenu>
                <p:submenu label="MenÃº">
                    <p:menuitem value="MenÃº" url="../../index.xhtml"/>
                </p:submenu>
            </p:panelMenu>
            
            <p:panelGrid columns="2">
                <p:outputLabel value="Cliente"/>
                <p:autoComplete value="#{ventaC.venta.IDPER}" completeMethod="#{ventaC.completar}" emptyMessage="No existe"
                                size="25" required="true" resultsMessage="Escribir el nombre del cliente"/>
                <p:outputLabel value="Fecha"/>
                <p:calendar value="#{ventaC.venta.FECVEN}" pattern="yyyy-MM-dd" mindate="@now" size="7"
                            required="true" requiredMessage="Ingresar fecha de Venta"/>                                    
                <p:commandButton value="Guardar" actionListener="#{ventaC.registrarC()}" update="venta :msg"/>
            </p:panelGrid>
        </h:form>
        
        <h:form id="detalle">
             <br/>
            <p:panelGrid columns="6">
                <p:outputLabel value="Producto"/>
                <p:autoComplete value="#{ventaDetC.ventaDet.IDEQU}" completeMethod="#{ventaDetC.completar}" emptyMessage="No existe"
                                required="true" resultsMessage="Escribir el nombre del equipo"/>
                <p:outputLabel value=" "/>
                <p:outputLabel value="Cantidad"/>
                <p:spinner value="#{ventaDetC.ventaDet.CANT}" required="true" requiredMessage="Ingresar cantidad" min="1" max="9999" maxlength="4">
                    <p:keyFilter regEx="/[0-9]/"/>
                </p:spinner>
                <p:commandButton icon="ui-icon-pencil" id="tool" actionListener="#{ventaDetC.registrarC()}" update="detalle :msg"/>
                <p:tooltip for="tool" value="Guardar" position="left"/>
            </p:panelGrid>
        </h:form>
        
        <h:form id="listVen">
            <br/>
            <p:dataTable id="tbPer" reflow="true" paginator="true" value="#{ventaDetC.listVentd}" var="lista" rows="10">
                <p:column headerText="Equipo" width="200">
                    <h:outputLabel value="#{lista.IDEQU}"/>
                </p:column>
                <p:column headerText="Cantidad" >
                    <h:outputText value="#{lista.CANT}"/>
                </p:column>
                <p:column headerText="Precio" >
                    <h:outputText value=" "/>
                </p:column>
                <p:column width="40">
                    <p:commandButton icon="ui-icon-pencil" oncomplete="PF('wdlgDatos').show();" id="tp" update=":dlgDatos">
                        <f:setPropertyActionListener value="#{lista}" target="#{ventaDetC.ventaDet}"/>
                    </p:commandButton>
                    <p:tooltip value="MODIFICAR" position="left" for="tp"/>
                </p:column>
            </p:dataTable>
        </h:form>

        <p:dialog id="dlgDatos" widgetVar="wdlgDatos" responsive="true" header="Modificar" modal="true">
            <h:form id="vnt">
                <p:panelGrid columns="5">
                <p:outputLabel value="Producto"/>
                <p:autoComplete value="#{ventaDetC.ventaDet.IDEQU}" completeMethod="#{ventaDetC.completar}" emptyMessage="No existe"
                                required="true" resultsMessage="Escribir el nombre del equipo"/>
                <p:outputLabel value=" "/>
                <p:outputLabel value="Cantidad"/>
                <p:spinner value="#{ventaDetC.ventaDet.CANT}" required="true" requiredMessage="Ingresar cantidad" min="1" max="9999" maxlength="4">
                    <p:keyFilter regEx="/[0-9]/"/>
                </p:spinner>
                <p:commandButton value="Modificar" actionListener="#{ventaDetC.modificarC()}" update="vnt :msg :listVen"
                                 oncomplete="if(args &amp;&amp; !args.validationFailed)PF('wdlgDatos').hide();"/>
            </p:panelGrid>
            </h:form>
        </p:dialog>
    </h:body>
</html>
